# -*- coding: utf-8 -*-
"""Báº£n sao cá»§a S5_MC4AI_ASM.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1W8Td1djoYuxgtOIIrBgbKr95RJYQ0j4U

<h1><center>

<img src="https://i.imgur.com/LSeMSbh.jpg" alt="logo" width="700" height="300">
<h1><b>SESSION 5 - LINEAR REGRESSION</b></h1>

</center></h1>

<h1><b><center>Æ¯á»šC LÆ¯á»¢NG DOANH THU Cá»¦A Má»˜T CÃ”NG TY BÃN KEM Dá»°A VÃ€O NHIá»†T Äá»˜ TRONG THÃNG</center></b></h1>

#**Create Data**

Táº¡o short-cut Ä‘áº¿n [**dataset**](https://drive.google.com/file/d/1wZETgqcnl0dQJ8FV3hI_Y64LK1KNfGyE/view?usp=share_link) tá»« Google Drive rá»“i cháº¡y cÃ¡c cell code dÆ°á»›i Ä‘Ã¢y Ä‘á»ƒ táº¡o data
"""

from google.colab import drive
drive.mount('/content/drive')

import pandas as pd
import numpy as np

df = pd.read_csv('/content/drive/MyDrive/IceCreamData.csv')
df.head()

x = df['Temperature'].values
y = df['Revenue'].values
x.shape, y.shape

"""#**TODO: Visualize Data**

Scatter cÃ¡c Ä‘iá»ƒm (x,y)
"""

# YOUR CODE HERE

"""#**TODO: Split Data**

TÃ¡ch táº­p dá»¯ liá»‡u (x,y) thÃ nh 2 táº­p train, test báº±ng thÆ° viá»‡n **scikit-learn** ([document](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html)) sao cho táº­p test cÃ³ 50 sample. In ra shape cá»§a cÃ¡c táº­p dá»¯ liá»‡u Ä‘á»ƒ biáº¿t káº¿t quáº£
"""

# YOUR CODE HERE

"""Scatter láº¡i 2 táº­p train, test (2 táº­p 2 mÃ u khÃ¡c nhau)"""

# YOUR CODE HERE

"""#**TODO: Create, Train, Evaluate**

Táº¡o vÃ  fit model trÃªn táº­p train (chÃº Ã½ shape)
"""

# YOUR CODE HERE

"""**Weights**"""

# YOUR CODE HERE

"""**Evaluate:** Ä‘Ã¡nh giÃ¡ model trÃªn táº­p test"""

# YOUR CODE HERE

"""#**TODO: Regression Line**

Scatter láº¡i táº­p (x,y) vÃ  plot Regression Line
"""

# YOUR CODE HERE

"""#**TODO: Save Model**"""

# YOUR CODE HERE

"""#**TODO: Deploy Streamlit App**

Táº¡o á»©ng dá»¥ng Streamlit (dÃ¹ng Streamlit Cloud) cho phÃ©p ngÆ°á»i dÃ¹ng nháº­p vÃ o nhiá»‡t Ä‘á»™, xuáº¥t ra doanh thu dá»± bÃ¡o trong thÃ¡ng

<center>
<img src="https://i.imgur.com/StAakCD.png"height="300">
<h1>
</center>

![]()

**LÆ°u Ã½:**
- CÃ³ thá»ƒ táº¡o repository má»›i (Ä‘áº·t tÃªn tuá»³ Ã½) hoáº·c dÃ¹ng láº¡i repository cÅ© (`my-first-streamlit-app`)
- Download file model Ä‘Ã£ lÆ°u á»Ÿ trÃªn rá»“i upload lÃªn repository, sau Ä‘Ã³ load láº¡i model (báº±ng thÆ° viá»‡n pickle) Ä‘á»ƒ dÃ¹ng cho predict
- requirements.txt
```
pickles
scikit-learn
```


---



**YOUR REPOSITORY LINK:**

#**Bonus**
LÃ m láº¡i bÃ i toÃ¡n trÃªn mÃ  khÃ´ng dÃ¹ng thÆ° viá»‡n `scikit-learn` (chá»‰ dÃ¹ng `numpy`)

**TÃ­nh ra bá»™ trá»ng sá»‘ báº±ng cÃ´ng thá»©c Ä‘áº¡o hÃ m**

Nháº¯c láº¡i cÃ´ng thá»©c tÃ­nh bá»™ trá»ng sá»‘ tá»‘i Æ°u cá»§a bÃ i toÃ¡n Linear Regression:

$$\bar{ğ°} = (\bar{ğ—}^T\bar{ğ—})^{-1}\bar{ğ—}^Tğ²$$

**LÆ°u Ã½:**
- DÃ¹ng hÃ m `np.linalg.pinv` Ä‘á»ƒ tÃ­nh ma tráº­n nghá»‹ch Ä‘áº£o (chá»‰ cÃ³ ma tráº­n vuÃ´ng má»›i cÃ³ ma tráº­n nghá»‹ch Ä‘áº£o)
- CÃ³ thá»ƒ dÃ¹ng `list` vÃ  vÃ²ng láº·p Ä‘á»ƒ táº¡o ma tráº­n $\bar{ğ—}$ (náº¿u khÃ´ng dÃ¹ng Ä‘Æ°á»£c cÃ¡c hÃ m `numpy`)
- Äá»ƒ nhÃ¢n ma tráº­n cÃ³ thá»ƒ dÃ¹ng cÃº phÃ¡p ngáº¯n gá»n nhÆ° sau
```python
c = a @ b # thay vÃ¬ c = np.dot(a,b)
```
"""

# YOUR CODE HERE

"""**TÃ­nh MAE, MSE** (báº±ng hÃ m numpy)"""

# YOUR CODE HERE

"""**Tá»± viáº¿t class LinearRegression** tÆ°Æ¡ng tá»± nhÆ° class cá»§a thÆ° viá»‡n `scikit-klearn` (gá»“m 2 hÃ m `fit` vÃ  `predict`), sau Ä‘Ã³ gá»i táº¡o Ä‘á»‘i tÆ°á»£ng cá»§a class rá»“i gá»i hÃ m Ä‘á»ƒ kiá»ƒm tra & so sÃ¡nh káº¿t quáº£"""

import numpy as np

# YOUR CODE HERE
class LinearRegression:
  def fit(self, x, y):
    pass

  def predict(self, x):
    pass